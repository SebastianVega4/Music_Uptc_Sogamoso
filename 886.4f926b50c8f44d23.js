"use strict";(self.webpackChunkuptc_music=self.webpackChunkuptc_music||[]).push([[886],{9355:(w,j,d)=>{d.r(j),d.d(j,{BuitresDetailComponent:()=>ie});var p=d(177),b=d(8435),u=d(4341),f=d(152),E=d(3294),m=d(5558),g=d(1413),e=d(6276),M=d(8440),D=d(3205),h=d(5455),r=d(3824);function c(o,a){if(1&o&&e.nrm(0,"img",55),2&o){const t=e.XpG(2);e.Y8G("src",t.person.image_url,e.B4B)}}function l(o,a){1&o&&e.nrm(0,"i",58)}function x(o,a){1&o&&e.nrm(0,"i",59)}function C(o,a){if(1&o&&(e.qex(0),e.DNE(1,l,1,0,"i",56),e.DNE(2,x,1,0,"i",57),e.bVm()),2&o){const t=e.XpG(2);e.R7$(1),e.Y8G("ngIf","male"===t.person.gender),e.R7$(1),e.Y8G("ngIf","female"===t.person.gender)}}function O(o,a){1&o&&(e.j41(0,"div",60),e.nrm(1,"i",61),e.j41(2,"span"),e.EFF(3,"Cambiar"),e.k0s()())}function S(o,a){if(1&o){const t=e.RV6();e.j41(0,"button",66),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.deletePerson())}),e.nrm(1,"i",67),e.EFF(2," Eliminar Perfil "),e.k0s()}}function P(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",62)(1,"button",63),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.startEditing())}),e.nrm(2,"i",64),e.EFF(3," Editar "),e.k0s(),e.DNE(4,S,3,0,"button",65),e.k0s()}if(2&o){const t=e.XpG(2);e.R7$(4),e.Y8G("ngIf",t.isAdmin)}}function I(o,a){1&o&&(e.j41(0,"div",75),e.nrm(1,"i",76),e.EFF(2," No puedes dejarte notas a ti mismo. "),e.k0s())}function y(o,a){if(1&o&&(e.j41(0,"div",72),e.nI1(1,"async"),e.nrm(2,"img",83),e.j41(3,"div",84),e.nrm(4,"i",85),e.nI1(5,"async"),e.nI1(6,"async"),e.k0s()()),2&o){const t=e.XpG().$implicit,n=e.XpG(3);e.AVh("playing",n.audioService.isCurrentSong(t.track_data.preview_url)&&e.bMT(1,8,n.audioService.isPlaying$)),e.R7$(2),e.Y8G("src",t.track_data.image,e.B4B)("alt",t.track_data.name),e.R7$(2),e.AVh("fa-pause",n.audioService.isCurrentSong(t.track_data.preview_url)&&e.bMT(5,10,n.audioService.isPlaying$))("fa-music",!(n.audioService.isCurrentSong(t.track_data.preview_url)&&e.bMT(6,12,n.audioService.isPlaying$)))}}function B(o,a){if(1&o&&(e.j41(0,"div",86),e.nrm(1,"i",87),e.k0s()),2&o){const t=e.XpG().$implicit;e.xc7("background",t.track_data.bg_color||"#333")}}function F(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",88),e.bIt("click",function(i){e.eBV(t);const s=e.XpG().$implicit,_=e.XpG(3);return i.stopPropagation(),e.Njj(_.deleteNote(s.id))}),e.nrm(1,"i",89),e.k0s()}}function N(o,a){if(1&o&&(e.j41(0,"div",90)(1,"span",91),e.EFF(2),e.k0s()()),2&o){const t=e.XpG().$implicit;e.R7$(2),e.JRh(t.dedication)}}function R(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",77),e.bIt("click",function(){const s=e.eBV(t).$implicit,_=e.XpG(3);return e.Njj("text"===s.track_data.type?null:_.playPreview(s.track_data.preview_url))}),e.DNE(1,y,7,14,"div",78),e.DNE(2,B,2,2,"div",79),e.DNE(3,F,2,0,"div",80),e.DNE(4,N,3,1,"div",81),e.j41(5,"span",82),e.EFF(6),e.k0s()()}if(2&o){const t=a.$implicit,n=e.XpG(3);e.R7$(1),e.Y8G("ngIf",!t.track_data.type||"song"===t.track_data.type),e.R7$(1),e.Y8G("ngIf","text"===t.track_data.type),e.R7$(1),e.Y8G("ngIf",n.isAdmin||n.isOwner),e.R7$(1),e.Y8G("ngIf",t.dedication),e.R7$(2),e.SpI(" ","text"===t.track_data.type?"Nota":t.track_data.name," ")}}function T(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",68),e.DNE(1,I,3,0,"div",69),e.j41(2,"div",70)(3,"div",71),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.openSongModal())}),e.j41(4,"div",72),e.nrm(5,"i",35),e.k0s(),e.j41(6,"span",73),e.EFF(7,"Tu nota"),e.k0s()(),e.DNE(8,R,7,5,"div",74),e.k0s()()}if(2&o){const t=e.XpG(2);e.R7$(1),e.Y8G("ngIf",t.isOwner),e.R7$(2),e.xc7("cursor",t.isOwner?"not-allowed":"pointer"),e.AVh("opacity-50",t.isOwner),e.R7$(5),e.Y8G("ngForOf",t.songNotes)}}function G(o,a){1&o&&e.nrm(0,"i",97)}function $(o,a){if(1&o){const t=e.RV6();e.j41(0,"i",98),e.bIt("click",function(i){e.eBV(t);const s=e.XpG().$implicit,_=e.XpG(2);return i.stopPropagation(),e.Njj(_.deleteDetail(s.id))}),e.k0s()}}function A(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",92)(1,"span",93),e.bIt("click",function(){const s=e.eBV(t).$implicit,_=e.XpG(2);return e.Njj(_.incrementDetail(s.content))}),e.EFF(2),e.k0s(),e.j41(3,"div",94),e.EFF(4),e.DNE(5,G,1,0,"i",95),e.DNE(6,$,1,0,"i",96),e.k0s()()}if(2&o){const t=a.$implicit,n=e.XpG(2);e.AVh("verified",t.is_verified),e.R7$(2),e.JRh(t.content),e.R7$(2),e.SpI(" ",t.occurrence_count," "),e.R7$(1),e.Y8G("ngIf",t.is_verified),e.R7$(1),e.Y8G("ngIf",n.isAdmin||n.isOwner)}}function V(o,a){if(1&o&&(e.j41(0,"div",99)(1,"small"),e.nrm(2,"i",67),e.EFF(3),e.k0s()()),2&o){const t=e.XpG(2);e.R7$(3),e.Lme(" Este usuario ha eliminado ",t.person.deletions_count," ",1===t.person.deletions_count?"elemento":"elementos"," ")}}function X(o,a){1&o&&(e.j41(0,"div",100),e.nrm(1,"i",76),e.EFF(2," No puedes comentarte a ti mismo. "),e.k0s())}function Y(o,a){if(1&o){const t=e.RV6();e.j41(0,"button",110),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.deleteComment(i.id))}),e.nrm(1,"i",111),e.k0s()}}function U(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",101)(1,"div",102)(2,"div")(3,"span",103),e.EFF(4),e.nI1(5,"slice"),e.k0s(),e.j41(6,"small",104),e.EFF(7),e.nI1(8,"date"),e.k0s()(),e.DNE(9,Y,2,0,"button",105),e.k0s(),e.j41(10,"p",106),e.EFF(11),e.k0s(),e.j41(12,"div",107)(13,"span",108),e.bIt("click",function(){const s=e.eBV(t).$implicit,_=e.XpG(2);return e.Njj(_.likeComment(s.id))}),e.nrm(14,"i",109),e.EFF(15),e.k0s()()()}if(2&o){const t=a.$implicit,n=e.XpG(2);e.R7$(4),e.SpI("An\xf3nimo #",e.brH(5,7,t.author_fingerprint,0,5),""),e.R7$(3),e.JRh(e.i5U(8,11,t.created_at,"short")),e.R7$(2),e.Y8G("ngIf",n.isAdmin||n.isOwner),e.R7$(2),e.JRh(t.content),e.R7$(2),e.AVh("liked-flash",n.flashCommentLikes[t.id]),e.R7$(2),e.SpI(" ",t.likes_count," ")}}function L(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.isOwner||i.isAdmin?i.editImage():null)}),e.j41(5,"div",7),e.DNE(6,c,1,1,"img",8),e.DNE(7,C,3,2,"ng-container",9),e.DNE(8,O,4,0,"div",10),e.k0s()()(),e.j41(9,"div",11)(10,"div",12)(11,"div",13)(12,"h1",14),e.EFF(13),e.k0s()(),e.DNE(14,P,5,1,"div",15),e.k0s(),e.j41(15,"div",16)(16,"button",17),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.vote("like"))}),e.nrm(17,"i",18),e.EFF(18),e.k0s(),e.j41(19,"button",19),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.vote("dislike"))}),e.nrm(20,"i",20),e.EFF(21),e.k0s(),e.j41(22,"button",21),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.requestRemoval())}),e.nrm(23,"i",22),e.EFF(24," Quiero eliminar mi perfil "),e.k0s()()()()(),e.DNE(25,T,9,6,"div",23),e.j41(26,"div",24)(27,"div",25)(28,"div",26)(29,"h3",27),e.nrm(30,"i",28),e.EFF(31,"Etiquetas"),e.k0s(),e.j41(32,"div",29),e.DNE(33,A,7,6,"div",30),e.k0s(),e.j41(34,"div",31)(35,"div",32)(36,"input",33),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.newDetailContent=i)})("keyup.enter",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.addDetail())}),e.k0s(),e.j41(37,"button",34),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.addDetail())}),e.nrm(38,"i",35),e.k0s()(),e.j41(39,"small",36),e.EFF(40,"Haz click en los tags para incrementar el numero"),e.k0s()(),e.DNE(41,V,4,2,"div",37),e.k0s()(),e.j41(42,"div",38)(43,"div",39)(44,"div",40)(45,"h3",41),e.nrm(46,"i",42),e.EFF(47,"Foro An\xf3nimo"),e.k0s()(),e.j41(48,"div",43)(49,"textarea",44),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.newComment=i)}),e.k0s(),e.DNE(50,X,3,0,"div",45),e.j41(51,"button",46),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.submitComment())}),e.EFF(52," Publicar Comentario "),e.k0s()(),e.j41(53,"div",47)(54,"label",48),e.EFF(55,"Ordenar por:"),e.k0s(),e.j41(56,"select",49),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.sortOption=i)})("change",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.sortComments())}),e.j41(57,"option",50),e.EFF(58,"M\xe1s Recientes"),e.k0s(),e.j41(59,"option",51),e.EFF(60,"M\xe1s Antiguos"),e.k0s(),e.j41(61,"option",52),e.EFF(62,"M\xe1s Populares"),e.k0s()()(),e.j41(63,"div",53),e.DNE(64,U,16,14,"div",54),e.k0s()()()()()}if(2&o){const t=e.XpG();let n;e.R7$(4),e.AVh("editable",t.isOwner||t.isAdmin),e.R7$(2),e.Y8G("ngIf",t.person.image_url),e.R7$(1),e.Y8G("ngIf",!t.person.image_url),e.R7$(1),e.Y8G("ngIf",t.isOwner||t.isAdmin),e.R7$(5),e.JRh(t.person.name),e.R7$(1),e.Y8G("ngIf",t.isAdmin||t.isOwner),e.R7$(2),e.AVh("animate-flash",t.flashLikes),e.Y8G("disabled",t.voting),e.R7$(2),e.SpI("",t.person.likes_count," "),e.R7$(1),e.AVh("animate-flash",t.flashDislikes),e.Y8G("disabled",t.voting),e.R7$(2),e.SpI("",t.person.dislikes_count," "),e.R7$(4),e.Y8G("ngIf",t.songNotes),e.R7$(7),e.AVh("animate-flash-bg",t.flashTags),e.R7$(1),e.Y8G("ngForOf",t.details),e.R7$(3),e.Y8G("ngModel",t.newDetailContent),e.R7$(1),e.Y8G("disabled",!t.newDetailContent),e.R7$(4),e.Y8G("ngIf",(null!==(n=t.person.deletions_count)&&void 0!==n?n:0)>0),e.R7$(8),e.Y8G("ngModel",t.newComment)("disabled",t.isOwner),e.R7$(1),e.Y8G("ngIf",t.isOwner),e.R7$(1),e.Y8G("disabled",!t.newComment||t.isOwner),e.R7$(5),e.Y8G("ngModel",t.sortOption),e.R7$(7),e.AVh("animate-flash-bg",t.flashComments),e.R7$(1),e.Y8G("ngForOf",t.comments)}}function z(o,a){1&o&&(e.j41(0,"div",130)(1,"div",131)(2,"span",132),e.EFF(3,"Buscando..."),e.k0s()()())}function K(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",133),e.bIt("click",function(){const s=e.eBV(t).$implicit,_=e.XpG(4);return e.Njj(_.selectSong(s))}),e.nrm(1,"img",134),e.j41(2,"div",135)(3,"div",136),e.EFF(4),e.k0s(),e.j41(5,"div",137),e.EFF(6),e.k0s()(),e.j41(7,"button",138),e.nrm(8,"i",139),e.k0s()()}if(2&o){const t=a.$implicit;e.R7$(1),e.Y8G("src",t.image,e.B4B),e.R7$(3),e.JRh(t.name),e.R7$(2),e.JRh(t.artists.join(", "))}}function W(o,a){1&o&&(e.j41(0,"div",140),e.EFF(1," No se encontraron canciones "),e.k0s())}function J(o,a){if(1&o&&(e.j41(0,"div",126),e.DNE(1,z,4,0,"div",127),e.DNE(2,K,9,3,"div",128),e.DNE(3,W,2,0,"div",129),e.k0s()),2&o){const t=e.XpG(3);e.R7$(1),e.Y8G("ngIf",t.isSearchingSongs),e.R7$(1),e.Y8G("ngForOf",t.songSearchResults),e.R7$(1),e.Y8G("ngIf",!t.isSearchingSongs&&0===t.songSearchResults.length&&t.songSearchQuery)}}function Q(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",141)(1,"div",142),e.nrm(2,"img",143),e.j41(3,"div")(4,"div",144),e.EFF(5),e.k0s(),e.j41(6,"small",145),e.EFF(7),e.k0s()(),e.j41(8,"button",146),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.selectedSong=null)}),e.EFF(9,"Cambiar"),e.k0s()(),e.j41(10,"div",27)(11,"label",147),e.EFF(12,"Dedicatoria (Opcional)"),e.k0s(),e.j41(13,"textarea",148),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(3);return e.Njj(s.newSongDedication=i)}),e.k0s(),e.j41(14,"small",149),e.EFF(15),e.k0s()()()}if(2&o){const t=e.XpG(3);e.R7$(2),e.Y8G("src",t.selectedSong.image,e.B4B),e.R7$(3),e.JRh(t.selectedSong.name),e.R7$(2),e.JRh(t.selectedSong.artists.join(", ")),e.R7$(6),e.Y8G("ngModel",t.newSongDedication),e.R7$(2),e.SpI("",t.newSongDedication.length,"/30")}}function H(o,a){if(1&o){const t=e.RV6();e.qex(0),e.j41(1,"div",121),e.nrm(2,"i",122),e.j41(3,"input",123),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.songSearchQuery=i)})("input",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.onSongSearchInput(i.songSearchQuery))}),e.k0s()(),e.DNE(4,J,4,3,"div",124),e.DNE(5,Q,16,5,"div",125),e.bVm()}if(2&o){const t=e.XpG(2);e.R7$(3),e.Y8G("ngModel",t.songSearchQuery),e.R7$(1),e.Y8G("ngIf",!t.selectedSong),e.R7$(1),e.Y8G("ngIf",t.selectedSong)}}function Z(o,a){if(1&o){const t=e.RV6();e.qex(0),e.j41(1,"div",27)(2,"label",147),e.EFF(3,"Tu Nota"),e.k0s(),e.j41(4,"textarea",150),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.newTextNoteContent=i)}),e.k0s(),e.j41(5,"small",149),e.EFF(6),e.k0s()(),e.j41(7,"div",151),e.nrm(8,"i",152),e.EFF(9," Esta nota ser\xe1 visible por 7 d\xedas. "),e.k0s(),e.bVm()}if(2&o){const t=e.XpG(2);e.R7$(4),e.Y8G("ngModel",t.newTextNoteContent),e.R7$(2),e.SpI("",t.newTextNoteContent.length,"/30")}}function q(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",112),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeSongModal())}),e.j41(1,"div",113),e.bIt("click",function(i){return i.stopPropagation()}),e.j41(2,"h3",114),e.EFF(3,"Dejar una Nota (7 d\xedas)"),e.k0s(),e.j41(4,"div",115)(5,"button",116),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.switchNoteTab("song"))}),e.nrm(6,"i",117),e.EFF(7," Canci\xf3n "),e.k0s(),e.j41(8,"button",116),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.switchNoteTab("text"))}),e.nrm(9,"i",118),e.EFF(10," Texto "),e.k0s()(),e.DNE(11,H,6,3,"ng-container",9),e.DNE(12,Z,10,2,"ng-container",9),e.j41(13,"div",119)(14,"button",120),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeSongModal())}),e.EFF(15,"Cancelar"),e.k0s(),e.j41(16,"button",34),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.postNote())}),e.EFF(17," Publicar "),e.k0s()()()()}if(2&o){const t=e.XpG();e.R7$(5),e.AVh("btn-primary","song"===t.activeNoteTab)("btn-outline-secondary","song"!==t.activeNoteTab),e.R7$(3),e.AVh("btn-primary","text"===t.activeNoteTab)("btn-outline-secondary","text"!==t.activeNoteTab),e.R7$(3),e.Y8G("ngIf","song"===t.activeNoteTab),e.R7$(1),e.Y8G("ngIf","text"===t.activeNoteTab),e.R7$(4),e.Y8G("disabled","song"===t.activeNoteTab&&!t.selectedSong||"text"===t.activeNoteTab&&!t.newTextNoteContent)}}function ee(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",27)(1,"label",147),e.EFF(2,"Nombre"),e.k0s(),e.j41(3,"input",162),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.editName=i)}),e.k0s()()}if(2&o){const t=e.XpG(2);e.R7$(3),e.Y8G("ngModel",t.editName)}}function te(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",27)(1,"label",147),e.EFF(2,"Correo Electr\xf3nico"),e.k0s(),e.j41(3,"input",163),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.editEmail=i)}),e.k0s()()}if(2&o){const t=e.XpG(2);e.R7$(3),e.Y8G("ngModel",t.editEmail)}}function ne(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",112),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.isEditing=!1)}),e.j41(1,"div",153),e.bIt("click",function(i){return i.stopPropagation()}),e.j41(2,"h3",154),e.EFF(3,"Editar Perfil"),e.k0s(),e.DNE(4,ee,4,1,"div",155),e.DNE(5,te,4,1,"div",155),e.j41(6,"div",27)(7,"label",147),e.EFF(8,"URL de Imagen (Opcional)"),e.k0s(),e.j41(9,"input",156),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.editImageUrl=i)}),e.k0s(),e.j41(10,"small",145),e.EFF(11,"Deja vac\xedo para usar el avatar por defecto."),e.k0s()(),e.j41(12,"div",27)(13,"label",147),e.EFF(14,"G\xe9nero"),e.k0s(),e.j41(15,"select",157),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.editGender=i)}),e.j41(16,"option",158),e.EFF(17,"Masculino"),e.k0s(),e.j41(18,"option",159),e.EFF(19,"Femenino"),e.k0s()()(),e.j41(20,"div",160)(21,"button",120),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.isEditing=!1)}),e.EFF(22,"Cancelar"),e.k0s(),e.j41(23,"button",161),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.saveEdits())}),e.EFF(24,"Guardar"),e.k0s()()()()}if(2&o){const t=e.XpG();e.R7$(4),e.Y8G("ngIf",t.isAdmin),e.R7$(1),e.Y8G("ngIf",t.isAdmin),e.R7$(4),e.Y8G("ngModel",t.editImageUrl),e.R7$(6),e.Y8G("ngModel",t.editGender)}}let ie=(()=>{class o{route;router;buitresService;authService;modalService;audioService;person=null;details=[];comments=[];songNotes=[];newComment="";newDetailContent="";voting=!1;fingerprint="";isAdmin=!1;isOwner=!1;showSongModal=!1;activeNoteTab="song";songSearchQuery="";songSearchResults=[];isSearchingSongs=!1;selectedSong=null;newSongDedication="";newTextNoteContent="";searchSubject=new g.B;flashLikes=!1;flashDislikes=!1;flashTags=!1;flashComments=!1;flashCommentLikes={};isEditing=!1;editName="";editEmail="";editGender="";editImageUrl="";sortOption="newest";subscriptions=[];constructor(t,n,i,s,_,k){this.route=t,this.router=n,this.buitresService=i,this.authService=s,this.modalService=_,this.audioService=k,this.subscriptions.push(this.searchSubject.pipe((0,f.B)(500),(0,E.F)(),(0,m.n)(v=>(this.isSearchingSongs=!0,v.trim()?this.buitresService.searchSongs(v):(this.isSearchingSongs=!1,[])))).subscribe({next:v=>{this.songSearchResults=v,this.isSearchingSongs=!1},error:()=>{this.isSearchingSongs=!1,this.songSearchResults=[]}}))}ngOnInit(){this.isAdmin=this.authService.isRoleAdmin(),this.fingerprint=this.getFingerprint(),this.route.params.subscribe(t=>{const n=t.id;n&&(this.loadData(n),this.setupRealtime(n))})}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}loadSongNotes(t){this.buitresService.getSongNotes(t).subscribe(n=>{this.songNotes=n})}openSongModal(){this.authService.isBuitresLoggedIn()?this.isOwner?this.modalService.alert("No puedes dejarte notas a ti mismo.","Acci\xf3n no permitida","warning"):(this.showSongModal=!0,this.activeNoteTab="song",this.songSearchQuery="",this.songSearchResults=[],this.selectedSong=null,this.newSongDedication="",this.newTextNoteContent=""):this.modalService.alert("Debes iniciar sesi\xf3n para dejar notas.","Acceso Restringido","warning")}closeSongModal(){this.showSongModal=!1}switchNoteTab(t){this.activeNoteTab=t}onSongSearchInput(t){this.searchSubject.next(t)}selectSong(t){this.selectedSong=t}postNote(){if(this.person)if("song"===this.activeNoteTab){if(!this.selectedSong)return;this.buitresService.addSongNote(this.person.id,this.selectedSong,this.newSongDedication,"song").subscribe({next:t=>{this.songNotes.unshift(t),this.closeSongModal(),this.modalService.alert("Canci\xf3n dedicada correctamente.","\xa1\xc9xito!","success")},error:t=>{console.error("Error posting song note:",t),this.modalService.alert("No se pudo dedicar la canci\xf3n.","Error","danger")}})}else{if(!this.newTextNoteContent.trim())return;this.buitresService.addSongNote(this.person.id,null,this.newTextNoteContent,"text").subscribe({next:t=>{this.songNotes.unshift(t),this.closeSongModal(),this.modalService.alert("Nota publicada correctamente.","\xa1\xc9xito!","success")},error:t=>{console.error("Error posting text note:",t),this.modalService.alert("No se pudo publicar la nota.","Error","danger")}})}}deleteNote(t){confirm("\xbfEst\xe1s seguro de eliminar esta nota?")&&this.buitresService.deleteSongNote(t).subscribe({next:()=>{this.songNotes=this.songNotes.filter(n=>n.id!==t),this.modalService.alert("Nota eliminada.","\xc9xito","success")},error:n=>{this.modalService.alert("No tienes permiso para eliminar esta nota.","Error","danger")}})}playPreview(t){t&&this.audioService.play(t)}getFingerprint(){let t=localStorage.getItem("user_fingerprint");return t||(t=Math.random().toString(36).substring(2)+Date.now().toString(36),localStorage.setItem("user_fingerprint",t)),t}setupRealtime(t){this.subscriptions.push(this.buitresService.subscribeToChanges("buitres_people",n=>{if(n.new&&n.new.id===t){const i=this.person?.likes_count||0,s=this.person?.dislikes_count||0;this.person={...this.person,...n.new},n.new.likes_count!==i&&this.triggerFlash("likes"),n.new.dislikes_count!==s&&this.triggerFlash("dislikes")}})),this.subscriptions.push(this.buitresService.subscribeToChanges("buitres_details",n=>{n.new&&n.new.person_id===t?(this.loadDetails(t),this.triggerFlash("tags")):n.old&&n.old.person_id===t&&this.loadDetails(t)})),this.subscriptions.push(this.buitresService.subscribeToChanges("buitres_comments",n=>{n.new&&n.new.person_id===t?(this.loadComments(t),this.triggerFlash("comments")):n.old&&n.old.person_id===t&&this.loadComments(t)}))}triggerFlash(t){"likes"===t&&(this.flashLikes=!0),"dislikes"===t&&(this.flashDislikes=!0),"tags"===t&&(this.flashTags=!0),"comments"===t&&(this.flashComments=!0),setTimeout(()=>{"likes"===t&&(this.flashLikes=!1),"dislikes"===t&&(this.flashDislikes=!1),"tags"===t&&(this.flashTags=!1),"comments"===t&&(this.flashComments=!1)},2e3)}loadData(t){this.buitresService.getPersonById(t).subscribe(n=>{this.person=n,this.checkOwnership()}),this.loadDetails(t),this.loadComments(t),this.loadSongNotes(t)}checkOwnership(){if(!this.person||this.isAdmin)return;const t=this.authService.currentBuitre.subscribe(n=>{this.isOwner=!!(n&&n.email&&this.person?.email)&&n.email.trim().toLowerCase()===this.person.email.trim().toLowerCase()});this.subscriptions.push(t)}loadDetails(t){this.buitresService.getDetails(t).subscribe(n=>this.details=n)}loadComments(t){this.buitresService.getComments(t).subscribe(n=>{this.comments=n,this.sortComments()})}sortComments(){"newest"===this.sortOption?this.comments.sort((t,n)=>new Date(n.created_at).getTime()-new Date(t.created_at).getTime()):"oldest"===this.sortOption?this.comments.sort((t,n)=>new Date(t.created_at).getTime()-new Date(n.created_at).getTime()):"likes"===this.sortOption&&this.comments.sort((t,n)=>n.likes_count-t.likes_count)}vote(t){!this.person||this.voting||(this.voting=!0,this.buitresService.votePerson(this.person.id,t,this.fingerprint).subscribe({next:()=>{this.loadData(this.person.id),this.voting=!1},error:n=>{this.modalService.alert(n.error?.error||"Ya has votado por esta persona.","Atenci\xf3n","warning"),this.voting=!1}}))}submitComment(){this.person&&this.newComment&&(this.isOwner?this.modalService.alert("No puedes publicar comentarios en tu propio perfil.","Acci\xf3n no permitida","warning"):(this.newComment.match(/\d/g)||[]).length>=10?this.modalService.alert("Por seguridad, no se permiten comentarios con n\xfameros de tel\xe9fono.","Aviso de Seguridad","warning"):this.buitresService.addComment(this.person.id,this.newComment,this.fingerprint).subscribe({next:n=>{this.modalService.alert("Comentario publicado correctamente.","\xa1\xc9xito!","success"),this.newComment="",n&&n.id?(this.comments.push(n),this.sortComments()):this.loadComments(this.person.id)},error:n=>{this.modalService.alert(n.error?.error||"No se pudo publicar el comentario. Intenta de nuevo.","Error","danger"),console.error("Comment error:",n)}}))}addDetail(){if(!this.person||!this.newDetailContent)return;if((this.newDetailContent.match(/\d/g)||[]).length>=10)return void this.modalService.alert("Por seguridad, no se permiten etiquetas con n\xfameros de tel\xe9fono.","Aviso de Seguridad","warning");const n=this.newDetailContent.toLowerCase().split(" ").map(i=>i.charAt(0).toUpperCase()+i.slice(1)).join(" ");this.incrementDetail(n),this.newDetailContent=""}incrementDetail(t){this.person&&this.buitresService.addOrIncrementDetail(this.person.id,t,this.fingerprint).subscribe({next:n=>{const i=n.action||"added",s=n.new_count||0;let _="";if("added"===i?_=`Apoyo agregado a "${t} " ${s}`:"removed"===i&&(_=n.deleted?`Etiqueta "${t}" eliminada (lleg\xf3 a 0 apoyos)`:`Apoyo removido de "${t}" (${s})`),this.modalService.alert(_,"\xa1\xc9xito!","success"),n.data){const k=this.details.findIndex(v=>v.content.toLowerCase()===t.toLowerCase());"removed"===n.action&&n.deleted?-1!==k&&this.details.splice(k,1):-1!==k?this.details[k]={...this.details[k],...n.data}:this.details.push(n.data),this.details.sort((v,oe)=>oe.occurrence_count-v.occurrence_count)}else this.loadDetails(this.person.id)},error:n=>{this.modalService.alert(n.error?.error||"No se pudo procesar la acci\xf3n.","Error","danger"),console.error("Error con tag:",n)}})}getEmail(t){return t?.email||""}startEditing(){this.person&&(this.editName=this.person.name,this.editEmail=this.person.email||"",this.editGender=this.person.gender,this.editImageUrl=this.person.image_url||"",this.isEditing=!0)}editImage(){!this.person||!this.isOwner&&!this.isAdmin||this.startEditing()}saveEdits(){if(!this.person||!this.editGender)return;const t={};if(this.isAdmin){if(!this.editName)return;const n=this.editName.toLowerCase().split(" ").map(i=>i.charAt(0).toUpperCase()+i.slice(1)).join(" ");t.name=n,t.email=this.editEmail}t.gender=this.editGender,t.image_url=this.editImageUrl,this.buitresService.updatePerson(this.person.id,t).subscribe({next:()=>{this.isEditing=!1,this.loadData(this.person.id)},error:n=>{console.error("Update error:",n),this.modalService.alert("Error al actualizar perfil.","Error","danger")}})}deleteComment(t){this.modalService.confirm("\xbfEst\xe1s seguro de eliminar este comentario?","Eliminar Comentario").subscribe(n=>{n&&this.buitresService.deleteComment(t).subscribe(()=>{this.modalService.alert("Comentario eliminado.","\xa1\xc9xito!","success"),this.person&&this.loadComments(this.person.id)})})}likeComment(t){this.person&&this.buitresService.likeComment(t,this.fingerprint).subscribe({next:n=>{this.flashCommentLikes[t]=!0,setTimeout(()=>this.flashCommentLikes[t]=!1,1e3);const i=this.comments.find(s=>s.id===t);i&&"number"==typeof n.new_likes?i.likes_count=n.new_likes:this.loadComments(this.person.id)},error:n=>{this.modalService.alert(n.error?.error||"No se pudo procesar el like.","Error","danger"),console.error("Error con like:",n)}})}deleteDetail(t){this.modalService.confirm("\xbfEst\xe1s seguro de eliminar esta etiqueta?","Eliminar Etiqueta").subscribe(n=>{n&&this.buitresService.deleteDetail(t).subscribe(()=>{this.modalService.alert("Etiqueta eliminada.","\xa1\xc9xito!","success"),this.person&&this.loadDetails(this.person.id)})})}deletePerson(){this.person&&this.modalService.confirm(`\xbfEst\xe1s seguro de eliminar permanentemente el perfil de "${this.person.name}"? Esta acci\xf3n no se puede deshacer.`,"Eliminar Perfil").subscribe(t=>{t&&this.person&&this.buitresService.deletePerson(this.person.id).subscribe({next:()=>{this.modalService.alert("Perfil eliminado.","\xa1\xc9xito!","success"),this.router.navigate(["/buitres"])},error:n=>this.modalService.alert("Error al eliminar perfil.","Error","danger")})})}requestRemoval(){if(!this.person)return;const n=encodeURIComponent(`Solicitud de eliminaci\xf3n de perfil: ${this.person.name}`),i=encodeURIComponent(`Hola johan,\n\nDeseo solicitar la eliminaci\xf3n del perfil "${this.person.name}" (ID: ${this.person.id}) del directorio comunitario de Buitres UPTC.\n\nAtentamente,\nUn integrante de la comunidad.`);window.location.href=`mailto:johan.vega01@uptc.edu.co?subject=${n}&body=${i}`}static \u0275fac=function(n){return new(n||o)(e.rXU(b.nX),e.rXU(b.Ix),e.rXU(M.m),e.rXU(D.u),e.rXU(h.B),e.rXU(r.U))};static \u0275cmp=e.VBU({type:o,selectors:[["app-buitres-detail"]],standalone:!0,features:[e.aNF],decls:3,vars:3,consts:[["class","detail-container mt-4 animate-fade-in",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"detail-container","mt-4","animate-fade-in"],[1,"profile-header","card-dark","mb-4"],[1,"row","align-items-center"],[1,"col-md-3"],[1,"profile-img-container",3,"click"],[1,"profile-img","d-flex","align-items-center","justify-content-center","overflow-hidden","position-relative"],["alt","Profile","class","w-100 h-100 object-fit-cover",3,"src",4,"ngIf"],[4,"ngIf"],["class","edit-overlay",4,"ngIf"],[1,"col-md-9"],[1,"d-flex","align-items-center","justify-content-center","gap-3"],[1,"person-title-section"],[1,"person-name","mb-0"],["class","d-flex gap-2",4,"ngIf"],[1,"vote-actions","mt-3","d-flex","align-items-center","gap-2"],[1,"btn","btn-outline-success",3,"disabled","click"],[1,"fas","fa-thumbs-up","me-2"],[1,"btn","btn-outline-danger",3,"disabled","click"],[1,"fas","fa-thumbs-down","me-2"],[1,"btn","btn-link","text-muted","btn-sm","ms-auto","text-decoration-none",3,"click"],[1,"fas","fa-user-slash","me-1"],["class","song-notes-container mb-4",4,"ngIf"],[1,"row"],[1,"col-md-4"],[1,"card-dark","h-100"],[1,"mb-3"],[1,"fas","fa-tags","me-2","text-primary"],[1,"tags-container","d-flex","flex-wrap","gap-2","mb-4"],["class","tag-item",3,"verified",4,"ngFor","ngForOf"],[1,"add-tag","mt-auto"],[1,"input-group"],["type","text","placeholder","Agregar etiqueta...",1,"form-control","form-dark",3,"ngModel","ngModelChange","keyup.enter"],[1,"btn","btn-primary",3,"disabled","click"],[1,"fas","fa-plus"],[1,"text-muted","mt-2","d-block"],["class","deletion-stats mt-3 pt-3 border-top border-secondary text-center",4,"ngIf"],[1,"col-md-8"],[1,"card-dark"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"mb-0"],[1,"fas","fa-comments","me-2","text-primary"],[1,"comment-input-area","mb-4"],["rows","3","placeholder","Escribe algo an\xf3nimamente, una vez enviado no se podra editar.Solo el due\xf1o del perfil lo puede eliminar",1,"form-control","form-dark",3,"ngModel","disabled","ngModelChange"],["class","alert alert-warning mt-2 mb-0 py-2",4,"ngIf"],[1,"btn","btn-primary","mt-2",3,"disabled","click"],[1,"d-flex","align-items-center"],[1,"text-muted","me-2","small"],[1,"form-select","form-select-sm","form-dark","w-auto",3,"ngModel","ngModelChange","change"],["value","newest"],["value","oldest"],["value","likes"],[1,"comments-list"],["class","comment-card",4,"ngFor","ngForOf"],["alt","Profile",1,"w-100","h-100","object-fit-cover",3,"src"],["class","fas fa-user-tie gender-avatar male",4,"ngIf"],["class","fas fa-user-graduate gender-avatar female",4,"ngIf"],[1,"fas","fa-user-tie","gender-avatar","male"],[1,"fas","fa-user-graduate","gender-avatar","female"],[1,"edit-overlay"],[1,"fas","fa-camera"],[1,"d-flex","gap-2"],[1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"fas","fa-edit","me-1"],["class","btn btn-outline-danger btn-sm",3,"click",4,"ngIf"],[1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"fas","fa-trash-alt","me-1"],[1,"song-notes-container","mb-4"],["class","alert alert-warning mb-3 py-2",4,"ngIf"],[1,"notes-scroll"],[1,"note-item","add-note",3,"click"],[1,"note-circle"],[1,"note-label"],["class","note-item",3,"click",4,"ngFor","ngForOf"],[1,"alert","alert-warning","mb-3","py-2"],[1,"fas","fa-exclamation-circle","me-2"],[1,"note-item",3,"click"],["class","note-circle",3,"playing",4,"ngIf"],["class","note-circle text-note",3,"background",4,"ngIf"],["class","delete-note-btn",3,"click",4,"ngIf"],["class","note-cloud",4,"ngIf"],[1,"note-label","text-truncate",2,"max-width","80px"],[3,"src","alt"],[1,"note-overlay"],[1,"fas"],[1,"note-circle","text-note"],[1,"fas","fa-sticky-note"],[1,"delete-note-btn",3,"click"],[1,"fas","fa-times"],[1,"note-cloud"],[1,"note-text"],[1,"tag-item"],[1,"tag-content",3,"click"],[1,"tag-badge"],["class","fas fa-check-circle ms-1",4,"ngIf"],["class","fas fa-times ms-2 text-danger cursor-pointer",3,"click",4,"ngIf"],[1,"fas","fa-check-circle","ms-1"],[1,"fas","fa-times","ms-2","text-danger","cursor-pointer",3,"click"],[1,"deletion-stats","mt-3","pt-3","border-top","border-secondary","text-center"],[1,"alert","alert-warning","mt-2","mb-0","py-2"],[1,"comment-card"],[1,"comment-header","d-flex","justify-content-between"],[1,"anon-id"],[1,"text-muted","ms-2"],["class","btn btn-link text-danger btn-sm p-0",3,"click",4,"ngIf"],[1,"comment-body"],[1,"comment-footer"],["title","Dar like",1,"text-muted","cursor-pointer","d-inline-flex","align-items-center",3,"click"],[1,"fas","fa-heart","me-1"],[1,"btn","btn-link","text-danger","btn-sm","p-0",3,"click"],[1,"fas","fa-trash-alt"],[1,"modal-overlay",3,"click"],[1,"modal-content","song-modal",3,"click"],[1,"text-white","mb-3"],[1,"modal-tabs","d-flex","gap-2","mb-3"],[1,"btn","btn-sm","flex-grow-1",3,"click"],[1,"fas","fa-music","me-1"],[1,"fas","fa-comment-alt","me-1"],[1,"d-flex","justify-content-end","gap-2","mt-auto"],[1,"btn","btn-secondary",3,"click"],[1,"search-box","mb-3"],[1,"fas","fa-search","search-icon"],["type","text","placeholder","Buscar en Spotify...",1,"form-control","form-dark","ps-5",3,"ngModel","ngModelChange","input"],["class","search-results custom-scroll",4,"ngIf"],["class","selected-song-form",4,"ngIf"],[1,"search-results","custom-scroll"],["class","text-center py-3",4,"ngIf"],["class","song-item",3,"click",4,"ngFor","ngForOf"],["class","text-center py-3 text-muted",4,"ngIf"],[1,"text-center","py-3"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"song-item",3,"click"],["alt","Album",1,"song-thumb",3,"src"],[1,"song-info"],[1,"song-name"],[1,"song-artist"],[1,"btn","btn-sm","btn-outline-primary"],[1,"fas","fa-check"],[1,"text-center","py-3","text-muted"],[1,"selected-song-form"],[1,"selected-song-preview","mb-3","p-2","border","rounded","border-secondary","d-flex","align-items-center","gap-3"],["alt","Album","width","50","height","50",1,"rounded",3,"src"],[1,"fw-bold"],[1,"text-muted"],[1,"btn","btn-sm","btn-outline-danger","ms-auto",3,"click"],[1,"form-label","text-white"],["rows","2","maxlength","30","placeholder","Escribe un mensaje corto...",1,"form-control","form-dark",3,"ngModel","ngModelChange"],[1,"text-muted","text-end","d-block"],["rows","3","maxlength","30","placeholder","Escribe algo corto...",1,"form-control","form-dark",3,"ngModel","ngModelChange"],[1,"alert","alert-info","py-2","small"],[1,"fas","fa-info-circle","me-1"],[1,"modal-content",3,"click"],[1,"text-white"],["class","mb-3",4,"ngIf"],["type","text","placeholder","https://ejemplo.com/foto.jpg",1,"form-control","form-dark",3,"ngModel","ngModelChange"],[1,"form-select","form-dark",3,"ngModel","ngModelChange"],["value","male"],["value","female"],[1,"d-flex","justify-content-end","gap-2","mt-4"],[1,"btn","btn-primary",3,"click"],["type","text",1,"form-control","form-dark",3,"ngModel","ngModelChange"],["type","email",1,"form-control","form-dark",3,"ngModel","ngModelChange"]],template:function(n,i){1&n&&(e.DNE(0,L,65,30,"div",0),e.DNE(1,q,18,11,"div",1),e.DNE(2,ne,25,4,"div",1)),2&n&&(e.Y8G("ngIf",i.person),e.R7$(1),e.Y8G("ngIf",i.showSongModal),e.R7$(1),e.Y8G("ngIf",i.isEditing&&(i.isAdmin||i.isOwner)))},dependencies:[p.MD,p.Sq,p.bT,p.Jj,p.P9,p.vh,b.iI,u.YN,u.xH,u.y7,u.me,u.wz,u.BC,u.tU,u.vS],styles:['.card-dark[_ngcontent-%COMP%]{background:#181818;border:1px solid #333;border-radius:15px;padding:25px;color:#fff}.profile-img-container.editable[_ngcontent-%COMP%]{cursor:pointer}.profile-img-container.editable[_ngcontent-%COMP%]   .profile-img[_ngcontent-%COMP%]:hover   .edit-overlay[_ngcontent-%COMP%]{opacity:1}.profile-img[_ngcontent-%COMP%]{width:120px;height:120px;border-radius:50%;background:#222;border:4px solid #333;overflow:hidden;position:relative}.edit-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.6);display:flex;flex-direction:column;align-items:center;justify-content:center;color:#fff;opacity:0;transition:opacity .2s;border-radius:50%}.edit-overlay[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:4px}.edit-overlay[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.8rem;font-weight:700}.gender-avatar[_ngcontent-%COMP%]{font-size:4rem}.gender-avatar.male[_ngcontent-%COMP%]{color:#519df5}.gender-avatar.female[_ngcontent-%COMP%]{color:#f551a3}.person-name[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:800;color:#fff}.person-desc[_ngcontent-%COMP%]{color:#b3b3b3;font-size:1.1rem}@keyframes _ngcontent-%COMP%_flash-update{0%{transform:scale(1)}50%{transform:scale(1.1);color:#1db954;text-shadow:0 0 10px rgba(29,185,84,.5)}to{transform:scale(1)}}@keyframes _ngcontent-%COMP%_flash-bg{0%{background-color:transparent}50%{background-color:#1db9541a}to{background-color:transparent}}.animate-flash[_ngcontent-%COMP%]{display:inline-block;animation:_ngcontent-%COMP%_flash-update .8s ease-out}.animate-flash-bg[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_flash-bg 1s ease-out}.tags-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px}.tag-item[_ngcontent-%COMP%]{display:flex;align-items:center;background:#282828;padding:5px 12px;border-radius:20px;border:1px solid #404040;transition:all .2s}.tag-item.verified[_ngcontent-%COMP%]{border-color:#1db954;background:rgba(29,185,84,.1)}.tag-content[_ngcontent-%COMP%]{font-size:.9rem;margin-right:8px}.tag-badge[_ngcontent-%COMP%]{background:#404040;padding:2px 8px;border-radius:10px;font-size:.75rem;cursor:pointer;display:flex;align-items:center}.tag-badge[_ngcontent-%COMP%]:hover{background:#505050}.tag-badge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#1db954}@keyframes _ngcontent-%COMP%_heart-pop{0%{transform:scale(1)}50%{transform:scale(1.4);color:#e91e63}to{transform:scale(1);color:#e91e63}}.liked-flash[_ngcontent-%COMP%]{color:#e91e63!important}.liked-flash[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_heart-pop .6s ease-out;color:#e91e63!important}.comment-footer[_ngcontent-%COMP%]   .cursor-pointer[_ngcontent-%COMP%]:hover, .comment-footer[_ngcontent-%COMP%]   .cursor-pointer[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:#e91e63!important}.comment-card[_ngcontent-%COMP%]{background:#282828;border-radius:10px;padding:15px;margin-bottom:15px}.comment-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:8px}.anon-id[_ngcontent-%COMP%]{color:#1db954;font-weight:700;font-size:.9rem}.form-dark[_ngcontent-%COMP%]{background:#282828;border:1px solid #404040;color:#fff}.form-dark[_ngcontent-%COMP%]:focus{background:#333;color:#fff;border-color:#1db954;box-shadow:none}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.85);display:flex;align-items:center;justify-content:center;z-index:2000;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px)}.modal-content[_ngcontent-%COMP%]{background:#181818;border:1px solid #333;padding:30px;border-radius:20px;width:90%;max-width:500px;box-shadow:0 10px 40px #00000080;animation:_ngcontent-%COMP%_modal-in .3s ease-out}@keyframes _ngcontent-%COMP%_modal-in{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.song-notes-container[_ngcontent-%COMP%]{overflow-x:auto;padding:10px 0;scrollbar-width:none}.song-notes-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.notes-scroll[_ngcontent-%COMP%]{display:flex;gap:20px;padding:0 10px;min-width:min-content}.note-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer;position:relative;width:80px}.note-item[_ngcontent-%COMP%]   .note-cloud[_ngcontent-%COMP%]{position:absolute;top:-35px;left:50%;transform:translate(-50%);background:white;color:#000;padding:4px 8px;border-radius:12px;font-size:.7rem;white-space:normal;text-align:center;box-shadow:0 2px 10px #0003;z-index:100;width:max-content;max-width:110px;line-height:1.1}.note-item[_ngcontent-%COMP%]   .note-cloud[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-5px;left:50%;transform:translate(-50%);width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid white}.note-item.add-note[_ngcontent-%COMP%]   .note-circle[_ngcontent-%COMP%]{border:2px dashed #666;background:#222;display:flex;align-items:center;justify-content:center}.note-item.add-note[_ngcontent-%COMP%]   .note-circle[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.5rem;color:#888}.note-item.add-note[_ngcontent-%COMP%]:hover   .note-circle[_ngcontent-%COMP%]{border-color:#1db954}.note-item.add-note[_ngcontent-%COMP%]:hover   .note-circle[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#1db954}.note-circle[_ngcontent-%COMP%]{width:70px;height:70px;border-radius:50%;padding:3px;background:linear-gradient(45deg,#f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%);position:relative;transition:transform .2s}.note-circle.playing[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse-border 1.5s infinite}.note-circle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:50%;border:3px solid #181818}.note-circle[_ngcontent-%COMP%]   .note-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.4);border-radius:50%;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .2s}.note-circle[_ngcontent-%COMP%]   .note-overlay[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff;font-size:1.2rem}.note-circle[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.note-circle[_ngcontent-%COMP%]:hover   .note-overlay[_ngcontent-%COMP%]{opacity:1}.note-label[_ngcontent-%COMP%]{font-size:.75rem;color:#ccc;text-align:center;max-width:100%}@keyframes _ngcontent-%COMP%_pulse-border{0%{box-shadow:0 0 #dc2743b3}70%{box-shadow:0 0 0 10px #dc274300}to{box-shadow:0 0 #dc274300}}.song-modal[_ngcontent-%COMP%]{height:80vh;display:flex;flex-direction:column}.search-box[_ngcontent-%COMP%]{position:relative}.search-box[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:15px;top:50%;transform:translateY(-50%);color:#888}.search-results[_ngcontent-%COMP%]{flex-grow:1;overflow-y:auto;border:1px solid #333;border-radius:10px;padding:10px;margin-bottom:20px}.song-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;padding:10px;border-radius:8px;cursor:pointer;transition:background .2s}.song-item[_ngcontent-%COMP%]:hover{background:#333}.song-item[_ngcontent-%COMP%]   .song-thumb[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:4px;object-fit:cover}.song-item[_ngcontent-%COMP%]   .song-info[_ngcontent-%COMP%]{flex-grow:1;min-width:0}.song-item[_ngcontent-%COMP%]   .song-info[_ngcontent-%COMP%]   .song-name[_ngcontent-%COMP%]{color:#fff;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.song-item[_ngcontent-%COMP%]   .song-info[_ngcontent-%COMP%]   .song-artist[_ngcontent-%COMP%]{color:#aaa;font-size:.85rem}.note-item[_ngcontent-%COMP%]:hover   .delete-note-btn[_ngcontent-%COMP%]{opacity:1;pointer-events:auto}.text-note[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:1.5rem;color:#333}.text-note[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{filter:drop-shadow(0 1px 2px rgba(0,0,0,.1))}.delete-note-btn[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;width:20px;height:20px;background:red;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.7rem;opacity:0;pointer-events:none;transition:opacity .2s;z-index:20;box-shadow:0 2px 5px #0000004d}.delete-note-btn[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.modal-tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{transition:all .2s;border-radius:20px;font-weight:500}']})}return o})()},3824:(w,j,d)=>{d.d(j,{U:()=>u});var p=d(4412),b=d(6276);let u=(()=>{class f{audio;currentUrlSubject=new p.t(null);isPlayingSubject=new p.t(!1);currentUrl$=this.currentUrlSubject.asObservable();isPlaying$=this.isPlayingSubject.asObservable();constructor(){this.audio=new Audio,this.audio.addEventListener("ended",()=>{this.stop()}),this.audio.addEventListener("pause",()=>{this.isPlayingSubject.next(!1)}),this.audio.addEventListener("play",()=>{this.isPlayingSubject.next(!0)})}play(m){console.log("AudioService: Request to play",m),m?this.currentUrlSubject.value===m?this.audio.paused?(console.log("AudioService: Resuming audio"),this.audio.play().catch(g=>console.error("AudioService: Error resuming:",g))):(console.log("AudioService: Pausing audio"),this.audio.pause()):(console.log("AudioService: Playing new song"),this.stop(),this.audio.src=m,this.audio.load(),this.audio.play().then(()=>console.log("AudioService: Playback started")).catch(g=>console.error("AudioService: Error playing audio:",g)),this.currentUrlSubject.next(m)):console.warn("AudioService: No URL provided")}pause(){this.audio.pause()}stop(){this.audio.pause(),this.audio.currentTime=0,this.currentUrlSubject.next(null),this.isPlayingSubject.next(!1)}isCurrentSong(m){return!!m&&this.currentUrlSubject.value===m}static \u0275fac=function(g){return new(g||f)};static \u0275prov=b.jDH({token:f,factory:f.\u0275fac,providedIn:"root"})}return f})()},3888:(w,j,d)=>{d.d(j,{b:()=>D,E:()=>M});var p=d(8359);class b extends p.yU{constructor(r,c){super()}schedule(r,c=0){return this}}const u={setInterval(h,r,...c){const{delegate:l}=u;return l?.setInterval?l.setInterval(h,r,...c):setInterval(h,r,...c)},clearInterval(h){const{delegate:r}=u;return(r?.clearInterval||clearInterval)(h)},delegate:void 0};var f=d(7908);const m={now:()=>(m.delegate||Date).now(),delegate:void 0};class g{constructor(r,c=g.now){this.schedulerActionCtor=r,this.now=c}schedule(r,c=0,l){return new this.schedulerActionCtor(this,r).schedule(l,c)}}g.now=m.now;const M=new class e extends g{constructor(r,c=g.now){super(r,c),this.actions=[],this._active=!1}flush(r){const{actions:c}=this;if(this._active)return void c.push(r);let l;this._active=!0;do{if(l=r.execute(r.state,r.delay))break}while(r=c.shift());if(this._active=!1,l){for(;r=c.shift();)r.unsubscribe();throw l}}}(class E extends b{constructor(r,c){super(r,c),this.scheduler=r,this.work=c,this.pending=!1}schedule(r,c=0){var l;if(this.closed)return this;this.state=r;const x=this.id,C=this.scheduler;return null!=x&&(this.id=this.recycleAsyncId(C,x,c)),this.pending=!0,this.delay=c,this.id=null!==(l=this.id)&&void 0!==l?l:this.requestAsyncId(C,this.id,c),this}requestAsyncId(r,c,l=0){return u.setInterval(r.flush.bind(r,this),l)}recycleAsyncId(r,c,l=0){if(null!=l&&this.delay===l&&!1===this.pending)return c;null!=c&&u.clearInterval(c)}execute(r,c){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const l=this._execute(r,c);if(l)return l;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(r,c){let x,l=!1;try{this.work(r)}catch(C){l=!0,x=C||new Error("Scheduled action threw falsy error")}if(l)return this.unsubscribe(),x}unsubscribe(){if(!this.closed){const{id:r,scheduler:c}=this,{actions:l}=c;this.work=this.state=this.scheduler=null,this.pending=!1,(0,f.o)(l,this),null!=r&&(this.id=this.recycleAsyncId(c,r,null)),this.delay=null,super.unsubscribe()}}}),D=M}}]);