"use strict";(self.webpackChunkuptc_music=self.webpackChunkuptc_music||[]).push([[179],{1179:(v,C,s)=>{s.r(C),s.d(C,{DiscussionComponent:()=>j});var m=s(177),d=s(4341),u=s(8435),t=s(6276),O=s(5154),P=s(3205);function h(a,l){if(1&a){const e=t.RV6();t.j41(0,"div",22),t.nrm(1,"i",23),t.EFF(2),t.j41(3,"button",24),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.error=null)}),t.nrm(4,"i",25),t.k0s()()}if(2&a){const e=t.XpG();t.R7$(2),t.SpI(" ",e.error," ")}}function k(a,l){if(1&a&&(t.j41(0,"div",41)(1,"small"),t.EFF(2),t.k0s()()),2&a){const e=t.XpG(2);t.R7$(2),t.SpI("Imagen seleccionada: ",e.selectedFile.name,"")}}function r(a,l){if(1&a){const e=t.RV6();t.j41(0,"div",26)(1,"div",27)(2,"h3"),t.EFF(3,"Crear Nuevo Buitreo"),t.k0s(),t.j41(4,"div",28)(5,"label"),t.EFF(6,"Imagen (opcional)"),t.k0s(),t.j41(7,"input",29),t.bIt("change",function(n){t.eBV(e);const c=t.XpG();return t.Njj(c.onFileSelected(n))}),t.k0s(),t.DNE(8,k,3,1,"div",30),t.k0s(),t.j41(9,"div",28)(10,"label",31),t.EFF(11,"T\xedtulo "),t.j41(12,"small",32),t.EFF(13,"(Opcional)"),t.k0s()(),t.j41(14,"input",33),t.bIt("ngModelChange",function(n){t.eBV(e);const c=t.XpG();return t.Njj(c.newThread.title=n)}),t.k0s(),t.j41(15,"small"),t.EFF(16),t.k0s()(),t.j41(17,"div",28)(18,"label",34),t.EFF(19,"Contenido "),t.j41(20,"span",35),t.EFF(21,"*"),t.k0s()(),t.j41(22,"textarea",36),t.bIt("ngModelChange",function(n){t.eBV(e);const c=t.XpG();return t.Njj(c.newThread.content=n)}),t.k0s()(),t.j41(23,"div",37)(24,"button",38),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return n.showCreateForm=!1,t.Njj(n.newThread={title:"",content:""})}),t.EFF(25," Cancelar "),t.k0s(),t.j41(26,"button",39),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.createThread())}),t.nrm(27,"i",40),t.EFF(28,"Publicar Hilo "),t.k0s()()()()}if(2&a){const e=t.XpG();t.R7$(8),t.Y8G("ngIf",e.selectedFile),t.R7$(6),t.Y8G("ngModel",e.newThread.title),t.R7$(2),t.SpI("",e.newThread.title.length,"/200 caracteres"),t.R7$(6),t.Y8G("ngModel",e.newThread.content),t.R7$(4),t.Y8G("disabled",!e.newThread.content.trim())}}function i(a,l){1&a&&(t.j41(0,"div",42),t.nrm(1,"div",43),t.j41(2,"p"),t.EFF(3,"Cargando hilos..."),t.k0s()())}function _(a,l){if(1&a){const e=t.RV6();t.j41(0,"div",44),t.nrm(1,"i",45),t.j41(2,"h3"),t.EFF(3,"\xa1S\xe9 el primero en empezar un buitreo!"),t.k0s(),t.j41(4,"p"),t.EFF(5,"A\xfan no hay hilos de discusi\xf3n. Crea el primero para hablar."),t.k0s(),t.j41(6,"button",5),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.showCreateForm=!0)}),t.nrm(7,"i",6),t.EFF(8,"Crear Primer Hilo "),t.k0s()()}}function p(a,l){if(1&a&&(t.j41(0,"div",63),t.nrm(1,"img",64),t.k0s()),2&a){const e=t.XpG().$implicit;t.R7$(1),t.Y8G("src",e.image_url,t.B4B)}}function x(a,l){if(1&a){const e=t.RV6();t.j41(0,"button",65),t.bIt("click",function(n){t.eBV(e);const c=t.XpG().$implicit,g=t.XpG(2);return t.Njj(g.deleteThread(c,n))}),t.nrm(1,"i",66),t.k0s()}}const b=function(a){return["/discussion/thread",a]};function E(a,l){if(1&a){const e=t.RV6();t.j41(0,"div",47),t.DNE(1,p,2,1,"div",48),t.j41(2,"div",49)(3,"div",50)(4,"h3",51)(5,"a",52),t.EFF(6),t.k0s()(),t.j41(7,"span",53),t.EFF(8),t.k0s()(),t.j41(9,"div",54)(10,"p"),t.EFF(11),t.k0s()(),t.j41(12,"div",55)(13,"div",56)(14,"button",57),t.bIt("click",function(n){const g=t.eBV(e).$implicit;return t.XpG(2).likeThread(g),t.Njj(n.stopPropagation())}),t.nrm(15,"i",58),t.j41(16,"span"),t.EFF(17),t.k0s()(),t.j41(18,"div",59),t.nrm(19,"i",60),t.j41(20,"span"),t.EFF(21),t.k0s()(),t.DNE(22,x,2,0,"button",61),t.k0s(),t.j41(23,"a",62),t.EFF(24," Leer m\xe1s "),t.k0s()()()()}if(2&a){const e=l.$implicit,o=t.XpG(2);t.R7$(1),t.Y8G("ngIf",e.image_url),t.R7$(4),t.Y8G("routerLink",t.eq3(11,b,e.id)),t.R7$(1),t.JRh(e.title),t.R7$(2),t.JRh(o.formatTimeAgo(e.updated_at)),t.R7$(3),t.JRh(e.content.length>150?e.content.substring(0,150)+"...":e.content),t.R7$(3),t.AVh("liked",e.user_has_liked),t.R7$(3),t.JRh(e.likes_count),t.R7$(4),t.JRh(e.comments_count),t.R7$(1),t.Y8G("ngIf",o.isAdmin),t.R7$(1),t.Y8G("routerLink",t.eq3(13,b,e.id))}}function F(a,l){if(1&a&&(t.qex(0),t.DNE(1,E,25,15,"div",46),t.bVm()),2&a){const e=t.XpG();t.R7$(1),t.Y8G("ngForOf",e.threads)}}function T(a,l){1&a&&(t.j41(0,"div",67)(1,"button",68),t.nrm(2,"i",69),t.EFF(3," Anterior "),t.k0s(),t.j41(4,"span",70),t.EFF(5,"P\xe1gina 1 de 1"),t.k0s(),t.j41(6,"button",68),t.EFF(7," Siguiente "),t.nrm(8,"i",71),t.k0s()())}let j=(()=>{class a{discussionService;authService;threads=[];showCreateForm=!1;newThread={title:"",content:""};isLoading=!1;sortBy="updated_at";error=null;isAdmin=!1;authorFingerprint="";constructor(e,o){this.discussionService=e,this.authService=o}ngOnInit(){this.authorFingerprint=localStorage.getItem("userFingerprint")||"unknown",this.checkAdminStatus(),this.loadThreads()}checkAdminStatus(){this.isAdmin=this.authService.isRoleAdmin()}loadThreads(){this.isLoading=!0,this.error=null,this.discussionService.getThreads(this.sortBy).subscribe({next:e=>{this.threads=e.map(o=>({...o,user_has_liked:this.discussionService.hasUserLiked("thread",o.id)})),this.isLoading=!1},error:e=>{console.error("Error loading threads:",e),this.error="Error al cargar los hilos. Por favor, intenta nuevamente.",this.isLoading=!1}})}selectedFile=null;onFileSelected(e){const o=e.target.files[0];o&&(this.selectedFile=o)}createThread(){this.newThread.content.trim()&&(this.selectedFile?(this.isLoading=!0,this.discussionService.uploadImage(this.selectedFile).subscribe({next:e=>{this.createThreadWithImage(e.url)},error:e=>{console.error("Error uploading image:",e),this.error="Error al subir la imagen. Intenta nuevamente.",this.isLoading=!1}})):this.createThreadWithImage())}createThreadWithImage(e){this.discussionService.createThread(this.newThread.title,this.newThread.content,e).subscribe({next:o=>{this.threads.unshift({...o,user_has_liked:!1}),this.showCreateForm=!1,this.newThread={title:"",content:""},this.selectedFile=null,this.error=null,this.isLoading=!1},error:o=>{console.error("Error creating thread:",o),this.error="Error al crear el hilo. Por favor, intenta nuevamente.",this.isLoading=!1}})}deleteThread(e,o){o.stopPropagation(),confirm("\xbfEst\xe1s seguro de que quieres eliminar este hilo? Esta acci\xf3n no se puede deshacer.")&&this.discussionService.deleteThread(e.id).subscribe({next:()=>{this.threads=this.threads.filter(n=>n.id!==e.id)},error:n=>{console.error("Error deleting thread:",n),alert("Error al eliminar el hilo")}})}likeThread(e){this.discussionService.likeThread(e.id).subscribe({next:o=>{e.likes_count=o.new_count,e.user_has_liked="liked"===o.action},error:o=>{console.error("Error liking thread:",o),this.error="Error al dar like. Por favor, intenta nuevamente."}})}formatTimeAgo(e){const o=new Date(e),c=(new Date).getTime()-o.getTime(),g=Math.floor(c/6e4),M=Math.floor(g/60),f=Math.floor(M/24);return g<1?"Ahora mismo":g<60?`Hace ${g} min`:M<24?`Hace ${M} h`:1===f?"Ayer":f<7?`Hace ${f} d\xedas`:f<30?`Hace ${Math.floor(f/7)} sem`:`Hace ${Math.floor(f/30)} mes`}static \u0275fac=function(o){return new(o||a)(t.rXU(O.u),t.rXU(P.u))};static \u0275cmp=t.VBU({type:a,selectors:[["app-discussion"]],standalone:!0,features:[t.aNF],decls:34,vars:10,consts:[[1,"discussion-container"],[1,"discussion-header"],[1,"header-content"],[1,"fas","fa-comments","me-2"],[1,"header-subtitle"],[1,"btn-create-thread",3,"click"],[1,"fas","fa-plus","me-1"],["class","alert alert-danger","role","alert",4,"ngIf"],["class","create-thread-form",4,"ngIf"],[1,"sort-controls"],[1,"sort-options"],[3,"ngModel","ngModelChange","change"],["value","updated_at"],["value","likes_count"],["value","comments_count"],["value","created_at"],[1,"threads-count"],[1,"threads-grid"],["class","loader",4,"ngIf"],["class","empty-state",4,"ngIf"],[4,"ngIf"],["class","pagination",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"fas","fa-exclamation-triangle","me-2"],["type","button",1,"btn-close",3,"click"],[1,"fas","fa-times"],[1,"create-thread-form"],[1,"form-card"],[1,"form-group"],["type","file","accept","image/*",1,"form-control-file",3,"change"],["class","text-success mt-1",4,"ngIf"],["for","threadTitle"],[1,"text-muted","fw-normal"],["type","text","id","threadTitle","placeholder","Escribe un t\xedtulo interesante... (Si lo dejas vac\xedo, usaremos el contenido)","maxlength","200",3,"ngModel","ngModelChange"],["for","threadContent"],[1,"text-danger"],["id","threadContent","placeholder","Comparte tus pensamientos, preguntas o temas musicales...","rows","6",3,"ngModel","ngModelChange"],[1,"form-actions"],[1,"btn-cancel",3,"click"],[1,"btn-submit",3,"disabled","click"],[1,"fas","fa-paper-plane","me-1"],[1,"text-success","mt-1"],[1,"loader"],[1,"spinner"],[1,"empty-state"],[1,"fas","fa-comments-slash"],["class","thread-card animate-fade-in",4,"ngFor","ngForOf"],[1,"thread-card","animate-fade-in"],["class","thread-image-cover",4,"ngIf"],[1,"thread-body"],[1,"thread-header"],[1,"thread-title"],[3,"routerLink"],[1,"thread-date"],[1,"thread-content-preview"],[1,"thread-footer"],[1,"thread-stats"],[1,"like-btn",3,"click"],[1,"fas","fa-heart"],[1,"stat-item"],[1,"fas","fa-comment"],["class","delete-btn","title","Eliminar hilo",3,"click",4,"ngIf"],[1,"btn-read-more",3,"routerLink"],[1,"thread-image-cover"],["alt","Cover del hilo",3,"src"],["title","Eliminar hilo",1,"delete-btn",3,"click"],[1,"fas","fa-trash-alt"],[1,"pagination"],["disabled","",1,"page-btn"],[1,"fas","fa-chevron-left","me-1"],[1,"page-info"],[1,"fas","fa-chevron-right","ms-1"]],template:function(o,n){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),t.nrm(4,"i",3),t.EFF(5,"Foro "),t.k0s(),t.j41(6,"p",4),t.EFF(7,"Comparte, discute y conecta con otros anonimamente"),t.k0s()(),t.j41(8,"button",5),t.bIt("click",function(){return n.showCreateForm=!n.showCreateForm}),t.nrm(9,"i",6),t.EFF(10),t.k0s()(),t.DNE(11,h,5,1,"div",7),t.DNE(12,r,29,5,"div",8),t.j41(13,"div",9)(14,"div",10)(15,"span"),t.EFF(16,"Ordenar por:"),t.k0s(),t.j41(17,"select",11),t.bIt("ngModelChange",function(g){return n.sortBy=g})("change",function(){return n.loadThreads()}),t.j41(18,"option",12),t.EFF(19,"M\xe1s reciente"),t.k0s(),t.j41(20,"option",13),t.EFF(21,"M\xe1s populares"),t.k0s(),t.j41(22,"option",14),t.EFF(23,"M\xe1s comentados"),t.k0s(),t.j41(24,"option",15),t.EFF(25,"M\xe1s antiguos"),t.k0s()()(),t.j41(26,"div",16)(27,"span"),t.EFF(28),t.k0s()()(),t.j41(29,"div",17),t.DNE(30,i,4,0,"div",18),t.DNE(31,_,9,0,"div",19),t.DNE(32,F,2,1,"ng-container",20),t.k0s(),t.DNE(33,T,9,0,"div",21),t.k0s()),2&o&&(t.R7$(10),t.SpI(" ",n.showCreateForm?"Cancelar":"Nuevo buitreo"," "),t.R7$(1),t.Y8G("ngIf",n.error),t.R7$(1),t.Y8G("ngIf",n.showCreateForm),t.R7$(5),t.Y8G("ngModel",n.sortBy),t.R7$(11),t.Lme("",n.threads.length," hilo",1!==n.threads.length?"s":"",""),t.R7$(2),t.Y8G("ngIf",n.isLoading),t.R7$(1),t.Y8G("ngIf",!n.isLoading&&0===n.threads.length),t.R7$(1),t.Y8G("ngIf",!n.isLoading&&n.threads.length>0),t.R7$(1),t.Y8G("ngIf",n.threads.length>0))},dependencies:[m.MD,m.Sq,m.bT,d.YN,d.xH,d.y7,d.me,d.wz,d.BC,d.tU,d.vS,u.iI,u.Wk],styles:['.discussion-container[_ngcontent-%COMP%]{max-width:900px;margin:0 auto;padding:2rem;animation:fadeIn .6s ease-out}.discussion-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;padding-bottom:1.5rem;border-bottom:1px solid rgba(255,255,255,.1)}.discussion-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:800;background:linear-gradient(135deg,var(--primary-color) 0%,var(--accent-purple) 100%);-webkit-text-fill-color:transparent;-webkit-background-clip:text;background-clip:text;margin-bottom:.5rem}.discussion-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-subtitle[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:1.1rem;margin:0}.discussion-header[_ngcontent-%COMP%]   .btn-create-thread[_ngcontent-%COMP%]{background:var(--primary-color);color:#fff;border:none;padding:1rem 2rem;border-radius:50px;font-weight:700;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 15px #1db9544d}.discussion-header[_ngcontent-%COMP%]   .btn-create-thread[_ngcontent-%COMP%]:hover{background:#1ed760;transform:translateY(-2px);box-shadow:0 6px 20px #1db95466}.discussion-header[_ngcontent-%COMP%]   .btn-create-thread[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.5rem}.create-thread-form[_ngcontent-%COMP%]{margin-bottom:2rem;animation:slideDown .3s ease-out}.create-thread-form[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]{background:var(--glass-bg);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.1);border-radius:16px;padding:2rem;box-shadow:0 8px 32px #0003}.create-thread-form[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--text-primary);margin-bottom:1.5rem;font-weight:700}.create-thread-form[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.create-thread-form[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--text-primary);font-weight:600;margin-bottom:.5rem}.create-thread-form[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .create-thread-form[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;background:rgba(42,42,42,.6);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:1rem;color:var(--text-primary);font-size:1rem;transition:all .3s ease}.create-thread-form[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .create-thread-form[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 2px #1db95433}.create-thread-form[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder, .create-thread-form[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]::placeholder{color:var(--text-tertiary)}.create-thread-form[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.8rem}.create-thread-form[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:flex-end}.create-thread-form[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]{background:rgba(255,255,255,.1);color:var(--text-secondary);border:1px solid rgba(255,255,255,.2);padding:.8rem 1.5rem;border-radius:50px;cursor:pointer;transition:all .3s ease}.create-thread-form[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:hover{background:rgba(255,255,255,.2);color:var(--text-primary)}.create-thread-form[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]{background:var(--primary-color);color:#fff;border:none;padding:.8rem 2rem;border-radius:50px;font-weight:700;cursor:pointer;transition:all .3s ease}.create-thread-form[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]:hover:not(:disabled){background:#1ed760;transform:translateY(-2px)}.create-thread-form[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]:disabled{background:var(--text-tertiary);cursor:not-allowed;transform:none}.sort-controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;padding:1rem 1.5rem;background:var(--glass-bg);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:12px;border:1px solid rgba(255,255,255,.1)}.sort-controls[_ngcontent-%COMP%]   .sort-options[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.sort-controls[_ngcontent-%COMP%]   .sort-options[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--text-secondary);font-weight:600}.sort-controls[_ngcontent-%COMP%]   .sort-options[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{background:rgba(42,42,42,.6);border:1px solid rgba(255,255,255,.1);border-radius:8px;padding:.5rem 1rem;color:var(--text-primary);cursor:pointer}.sort-controls[_ngcontent-%COMP%]   .sort-options[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color)}.sort-controls[_ngcontent-%COMP%]   .threads-count[_ngcontent-%COMP%]{color:var(--text-primary);font-weight:700;background:var(--primary-color);padding:.5rem 1rem;border-radius:20px;font-size:.9rem}.threads-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1.5rem;animation:fadeIn .5s ease-out}.threads-grid[_ngcontent-%COMP%]   .loader[_ngcontent-%COMP%], .threads-grid[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{grid-column:1/-1}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]{background:var(--glass-bg);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.1);border-radius:16px;overflow:hidden;transition:all .3s cubic-bezier(.25,.8,.25,1);display:flex;flex-direction:column;height:100%;position:relative}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]:hover{transform:translateY(-8px);box-shadow:0 12px 40px #00000040;border-color:#1db9544d;z-index:10}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-image-cover[_ngcontent-%COMP%]{width:100%;height:180px;overflow:hidden;position:relative}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-image-cover[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;transition:transform .5s ease}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-image-cover[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:0;width:100%;height:50%;background:linear-gradient(to top,rgba(0,0,0,.6),transparent)}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]:hover   .thread-image-cover[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transform:scale(1.05)}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-body[_ngcontent-%COMP%]{padding:1.5rem;display:flex;flex-direction:column;flex-grow:1}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-header[_ngcontent-%COMP%]{margin-bottom:.8rem}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-header[_ngcontent-%COMP%]   .thread-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;margin:0 0 .5rem;line-height:1.3}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-header[_ngcontent-%COMP%]   .thread-title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--text-primary);text-decoration:none}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-header[_ngcontent-%COMP%]   .thread-title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--primary-color)}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-header[_ngcontent-%COMP%]   .thread-date[_ngcontent-%COMP%]{font-size:.8rem;color:var(--text-tertiary)}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-content-preview[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.95rem;line-height:1.5;margin-bottom:1.5rem;flex-grow:1}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-content-preview[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-top:1px solid rgba(255,255,255,.05);padding-top:1rem;margin-top:auto}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-footer[_ngcontent-%COMP%]   .thread-stats[_ngcontent-%COMP%]{display:flex;gap:1rem}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-footer[_ngcontent-%COMP%]   .thread-stats[_ngcontent-%COMP%]   .like-btn[_ngcontent-%COMP%], .threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-footer[_ngcontent-%COMP%]   .thread-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.4rem;color:var(--text-secondary);font-size:.9rem;background:none;border:none;padding:0}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-footer[_ngcontent-%COMP%]   .thread-stats[_ngcontent-%COMP%]   .like-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-footer[_ngcontent-%COMP%]   .thread-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-footer[_ngcontent-%COMP%]   .thread-stats[_ngcontent-%COMP%]   .like-btn[_ngcontent-%COMP%]{cursor:pointer;transition:color .2s}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-footer[_ngcontent-%COMP%]   .thread-stats[_ngcontent-%COMP%]   .like-btn[_ngcontent-%COMP%]:hover, .threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-footer[_ngcontent-%COMP%]   .thread-stats[_ngcontent-%COMP%]   .like-btn.liked[_ngcontent-%COMP%]{color:#e74c3c}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-footer[_ngcontent-%COMP%]   .btn-read-more[_ngcontent-%COMP%]{font-size:.9rem;color:var(--primary-color);text-decoration:none;font-weight:600}.threads-grid[_ngcontent-%COMP%]   .thread-card[_ngcontent-%COMP%]   .thread-footer[_ngcontent-%COMP%]   .btn-read-more[_ngcontent-%COMP%]:hover{text-decoration:underline}@media (max-width: 768px){.discussion-container[_ngcontent-%COMP%]{padding:1rem}.threads-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}.discussion-header[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;text-align:center}}']})}return a})()},5154:(v,C,s)=>{s.d(C,{u:()=>P});var m=s(8141),d=s(5312),u=s(6276),t=s(1626),O=s(3205);let P=(()=>{class h{http;authService;apiUrl=d.c.apiUrl;likedItems=new Set;constructor(r,i){this.http=r,this.authService=i,this.loadLikedItemsFromStorage()}loadLikedItemsFromStorage(){const r=localStorage.getItem("discussion_likes");r&&(this.likedItems=new Set(JSON.parse(r)))}saveLikedItemsToStorage(){localStorage.setItem("discussion_likes",JSON.stringify([...this.likedItems]))}getItemKey(r,i){return`${r}:${i}`}hasUserLiked(r,i){return this.likedItems.has(this.getItemKey(r,i))}updateLikeStatus(r,i,_){const p=this.getItemKey(r,i);_?this.likedItems.add(p):this.likedItems.delete(p),this.saveLikedItemsToStorage()}getThreads(r="updated_at",i="desc"){return this.http.get(`${this.apiUrl}/api/discussion/threads?sort=${r}&order=${i}`)}getThread(r){return this.http.get(`${this.apiUrl}/api/discussion/threads/${r}`)}createThread(r,i,_){return this.http.post(`${this.apiUrl}/api/discussion/threads`,{title:r,content:i,image_url:_},{headers:this.authService.getAuthHeaders()})}uploadImage(r){const i=new FormData;return i.append("file",r),this.http.post(`${d.c.apiUrl}/api/upload`,i)}addComment(r,i,_){return this.http.post(`${this.apiUrl}/api/discussion/threads/${r}/comments`,{content:i,parent_comment_id:_})}likeThread(r){return this.http.post(`${this.apiUrl}/api/discussion/like`,{thread_id:r}).pipe((0,m.M)(i=>{this.updateLikeStatus("thread",r,"liked"===i.action)}))}likeComment(r){return this.http.post(`${this.apiUrl}/api/discussion/like`,{comment_id:r}).pipe((0,m.M)(i=>{this.updateLikeStatus("comment",r,"liked"===i.action)}))}deleteThread(r){return this.http.delete(`${this.apiUrl}/api/discussion/threads/${r}`,{headers:this.authService.getAuthHeaders()})}updateThread(r,i){return this.http.put(`${this.apiUrl}/api/discussion/threads/${r}`,i,{headers:this.authService.getAuthHeaders()})}deleteComment(r){return this.http.delete(`${this.apiUrl}/api/discussion/comments/${r}`,{headers:this.authService.getAuthHeaders()})}updateComment(r,i){return this.http.put(`${this.apiUrl}/api/discussion/comments/${r}`,{content:i},{headers:this.authService.getAuthHeaders()})}static \u0275fac=function(i){return new(i||h)(u.KVO(t.Qq),u.KVO(O.u))};static \u0275prov=u.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()}}]);